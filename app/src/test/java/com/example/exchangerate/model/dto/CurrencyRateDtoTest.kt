package com.example.exchangerate.model.dto

import com.example.exchangerate.TestUtil
import com.example.exchangerate.framework.network.model.CurrencyRatesResponse
import com.example.exchangerate.model.CurrencyRate
import com.example.exchangerate.model.dto.CurrencyRateDto.asCurrencyRateDomainModel
import com.google.common.truth.Truth
import com.google.gson.Gson
import org.junit.Test

class CurrencyRateDtoTest {
    @Test
    fun asCurrencyRateDomainModel() {
        javaClass.classLoader?.let {
            val apiResponse = Gson().fromJson(
                TestUtil.readFile("latest.json"),
                CurrencyRatesResponse::class.java
            )

            val result = apiResponse.asCurrencyRateDomainModel()

            val expectedResult = CurrencyRate(
                updatedAt = 1665086400,
                rates = mapOf(
                    "AED" to 3.673,
                    "AFN" to 87.863016,
                    "ALL" to 118.6,
                    "AMD" to 405.210825,
                    "ANG" to 1.804042,
                    "AOA" to 434.68735,
                    "ARS" to 149.180132,
                    "AUD" to 1.560064,
                    "AWG" to 1.8,
                    "AZN" to 1.7,
                    "BAM" to 1.980487,
                    "BBD" to 2.0,
                    "BDT" to 103.678887,
                    "BGN" to 1.995439,
                    "BHD" to 0.377428,
                    "BIF" to 2050.0,
                    "BMD" to 1.0,
                    "BND" to 1.426546,
                    "BOB" to 6.916947,
                    "BRL" to 5.2099,
                    "BSD" to 1.0,
                    "BTC" to 0.000049916088,
                    "BTN" to 81.925751,
                    "BWP" to 13.240816,
                    "BYN" to 2.538707,
                    "BZD" to 2.017254,
                    "CAD" to 1.375036,
                    "CDF" to 2044.0,
                    "CHF" to 0.990582,
                    "CLF" to 0.034212,
                    "CLP" to 944.01,
                    "CNH" to 7.081999,
                    "CNY" to 7.116,
                    "COP" to 4623.131659,
                    "CRC" to 629.851658,
                    "CUC" to 1.0,
                    "CUP" to 25.75,
                    "CVE" to 112.85,
                    "CZK" to 25.019001,
                    "DJF" to 178.206915,
                    "DKK" to 7.593604,
                    "DOP" to 53.575,
                    "DZD" to 140.698506,
                    "EGP" to 19.6418,
                    "ERN" to 15.0,
                    "ETB" to 52.6,
                    "EUR" to 1.020811,
                    "FJD" to 2.30265,
                    "FKP" to 0.896342,
                    "GBP" to 0.896342,
                    "GEL" to 2.795,
                    "GGP" to 0.896342,
                    "GHS" to 10.45,
                    "GIP" to 0.896342,
                    "GMD" to 55.6,
                    "GNF" to 8755.0,
                    "GTQ" to 7.907874,
                    "GYD" to 209.425195,
                    "HKD" to 7.85005,
                    "HNL" to 24.77,
                    "HRK" to 7.6834,
                    "HTG" to 120.621732,
                    "HUF" to 432.470684,
                    "IDR" to 15235.1,
                    "ILS" to 3.532435,
                    "IMP" to 0.896342,
                    "INR" to 82.258898,
                    "IQD" to 1460.0,
                    "IRR" to 42300.0,
                    "ISK" to 142.33,
                    "JEP" to 0.896342,
                    "JMD" to 152.727973,
                    "JOD" to 0.709,
                    "JPY" to 145.12075,
                    "KES" to 120.9,
                    "KGS" to 80.326903,
                    "KHR" to 4130.0,
                    "KMF" to 501.874891,
                    "KPW" to 900.0,
                    "KRW" to 1409.41213,
                    "KWD" to 0.310005,
                    "KYD" to 0.834186,
                    "KZT" to 471.62676,
                    "LAK" to 16625.833333,
                    "LBP" to 1534.36667,
                    "LKR" to 362.867334,
                    "LRD" to 153.64996,
                    "LSL" to 17.92,
                    "LYD" to 4.99,
                    "MAD" to 10.9525,
                    "MDL" to 19.349933,
                    "MGA" to 4210.0,
                    "MKD" to 62.125671,
                    "MMK" to 2102.131339,
                    "MNT" to 3275.231028,
                    "MOP" to 8.093382,
                    "MRU" to 37.96,
                    "MUR" to 45.703671,
                    "MVR" to 15.46,
                    "MWK" to 1024.5,
                    "MXN" to 20.128079,
                    "MYR" to 4.6375,
                    "MZN" to 63.899991,
                    "NAD" to 17.92,
                    "NGN" to 433.4,
                    "NIO" to 35.98,
                    "NOK" to 10.713446,
                    "NPR" to 131.082993,
                    "NZD" to 1.768539,
                    "OMR" to 0.385052,
                    "PAB" to 1.0,
                    "PEN" to 3.9675,
                    "PGK" to 3.525,
                    "PHP" to 58.865501,
                    "PKR" to 223.0,
                    "PLN" to 4.989723,
                    "PYG" to 7073.121196,
                    "QAR" to 3.641,
                    "RON" to 5.0412,
                    "RSD" to 119.773495,
                    "RUB" to 60.524998,
                    "RWF" to 1042.0,
                    "SAR" to 3.758487,
                    "SBD" to 8.153446,
                    "SCR" to 13.099469,
                    "SDG" to 572.0,
                    "SEK" to 11.148009,
                    "SGD" to 1.429036,
                    "SHP" to 0.896342,
                    "SLL" to 13900.0,
                    "SOS" to 567.5,
                    "SRD" to 28.6845,
                    "SSP" to 130.26,
                    "STD" to 22750.290504,
                    "STN" to 25.15,
                    "SVC" to 8.757949,
                    "SYP" to 2512.53,
                    "SZL" to 17.92,
                    "THB" to 37.392333,
                    "TJS" to 9.985014,
                    "TMT" to 3.5,
                    "TND" to 3.2445,
                    "TOP" to 2.421265,
                    "TRY" to 18.5784,
                    "TTD" to 6.780955,
                    "TWD" to 31.559501,
                    "TZS" to 2332.0,
                    "UAH" to 36.969195,
                    "UGX" to 3823.849478,
                    "USD" to 1.0,
                    "UYU" to 40.998002,
                    "UZS" to 11075.0,
                    "VES" to 8.1984,
                    "VND" to 23880.0,
                    "VUV" to 120.740439,
                    "WST" to 2.765394,
                    "XAF" to 669.607908,
                    "XAG" to 0.04838281,
                    "XAU" to 0.00058336,
                    "XCD" to 2.70255,
                    "XDR" to 0.74392,
                    "XOF" to 669.607908,
                    "XPD" to 0.00044072,
                    "XPF" to 121.815116,
                    "XPT" to 0.00107992,
                    "YER" to 250.249937,
                    "ZAR" to 18.002424,
                    "ZMW" to 15.820811,
                    "ZWL" to 322.0
                )
            )

            Truth.assertThat(result).isEqualTo(expectedResult)
        }
    }
}